<!DOCTYPE html>
<html>
<head>
  <title>Application Detail</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<table>
  <tbody id="application-detail-container">
  <!-- application detail will be dynamically generated by JavaScript code -->
  </tbody>
</table>
<div>
  <button id="approve-btn">승인</button>
  <button id="reject-btn">거절</button>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  var applicationNum = window.location.pathname.split('/').pop();

  // 버튼 클릭 이벤트 핸들러 함수
  function handleButtonClick(event) {
    var action = event.target.id === "approve-btn" ? "approve" : "reject";
    var dataToSend = {
      user_num: applicationNum,
      action: action
    };
    $.ajax({
      url: "/application/action",
      type: "POST",
      dataType: "json",
      data: dataToSend,
      success: function(response) {
        console.log("Application action succeeded.");
      },
      error: function() {
        console.log("Error occurred while processing application action.");
      }
    });
  }

  // 버튼 클릭 이벤트 등록
  $("#approve-btn").on("click", handleButtonClick);
  $("#reject-btn").on("click", handleButtonClick);

  // 신청서 정보 요청 및 출력
  $.ajax({
    url: "/application/detail/" + applicationNum,
    type: "GET",
    dataType: "json",
    success: function(data) {
      var table = $("<table></table>");
      table.append("<tr><td>학번</td><td>" + data.studentId + "</td></tr>");
      table.append("<tr><td>이름</td><td>" + data.userName + "</td></tr>");
      table.append("<tr><td>지원 동기</td><td>" + data.motive + "</td></tr>");
      table.append("<tr><td>원하는 연구활동</td><td>" + data.wanted + "</td></tr>");
      table.append("<tr><td>자기 소개</td><td>" + data.intro + "</td></tr>");
      $("#application-detail-container").append(table);
    },
    error: function() {
      console.log("Error occurred while loading application detail.");
    }
  });
</script>
</body>
</html>
